---
import config from "virtual:astrocraft/config";
import CSSProps from "../components/CSSProps.astro";
import { pathWithBase } from "../utils/base";

import 'virtual:astrocraft/css';

const { lang, blockSize } = config;
---

<html
  {lang}
  style={(blockSize && `--mc-block-size:${blockSize}px;`) || null}
  class="h-full"
>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Not found</title>
    <CSSProps />
  </head>
  <body class="flex flex-col h-full scrollbar bg-mc-block-dirt select-none">
    <div class="grow bg-black/75">
      <div class="flex flex-col items-center justify-center h-full gap-8">
        <h1
          id="_error-code"
          class="text-shadow-sm text-7xl md:text-9xl text-mc-dark-red"
        >
          404
        </h1>
        <div
          class="flex flex-col items-center max-w-3xl w-full gap-1 px-12 md:px-24"
        >
          <p id="_error-top" class="text-center text-mc-gray-2">
            Failed to connect to the server
          </p>
          <p id="_error-bottom" class="text-center text-white">
            Error: internal server error
          </p>
          <a
            href={pathWithBase("/")}
            class="mc-button text-center w-full py-2 px-8 mt-1 text-lg"
            >Back to title screen</a
          >
        </div>
      </div>
    </div>

    <script is:inline>
      const errorCodeElement = document.getElementById("_error-code");

      setInterval(() => {
        errorCodeElement.classList.toggle("text-mc-dark-red");
        errorCodeElement.classList.toggle("text-mc-red");
      }, 1250);

      const topMessageElement = document.getElementById("_error-top");
      const bottomMessageElement = document.getElementById("_error-bottom");

      const messages = {
        "Failed to connect to the server": [
          "Failed to verify username!",
          "Failed to authenticate your connection",
          "Connection timed out: connect",
          "Internal Exception: io.netty.handler.timeout.ReadTimeOutException",
          "Failed to login: The server encountered an unexpected condition which prevented it from fulfilling the request",
        ],
        "Connection Lost": [
          "Timed out",
          "Disconnected",
          "Server closed",
          "Too many packets (extreme lag?)",
          "Error: internal server error",
          "A fatal error has occured, this connection has been teminated",
          "Internal Exception: java.IOException: An existing connection was forcibly closed by the remote host",
        ],
        "Diconnected by server": [
          "Internal server error",
          "Outdated server!",
          "You logged in from another location",
          "Banned: GRIEFER!!!",
        ],
      };

      const getRandomItem = (array) =>
        array[Math.floor(Math.random() * array.length)];
      const randomMessageTop = getRandomItem(Object.keys(messages));
      const randomMessageBottom = getRandomItem(messages[randomMessageTop]);

      topMessageElement.textContent = randomMessageTop;
      bottomMessageElement.textContent = randomMessageBottom;
    </script>
  </body>
</html>
