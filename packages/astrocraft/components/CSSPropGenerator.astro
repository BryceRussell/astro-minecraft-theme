---
import {
  blocks,
  items,
  paintings,
  icons,
  ui,
} from "virtual:astrocraft/user-images";

const fileName = (path: string) => path.split("/").pop()!.split(".")[0]!;

const kebab = (k: string) =>
	k.toLowerCase() === k ? k : k.replace(/[A-Z]/g, (match) => `-${match.toLowerCase()}`);

const toStyleString = (obj: Record<string, any>) =>
	Object.entries(obj)
		.map(([k, v]) => `--${kebab(k)}:${v}`)
		.join(';');

function createCSSPropObject(
  prefix: string,
  images: Record<string, ImageMetadata>
) {
  return Object.keys(images).reduce((acc, key) => {
    return {
      ...acc,
      [`mc-${prefix}-${fileName(key)}`]: `url("${images[key].default.src}")`,
    };
  }, {});
}
---

<!-- BLOCK PROPS -->
<style set:html={`:root {${toStyleString(createCSSPropObject("block", blocks))}}`}></style>
<!-- ITEM PROPS -->
<style
  set:html={`:root {${toStyleString(createCSSPropObject("item", items))}}`}
></style>
<!-- PAINTING PROPS -->
<style
  set:html={`:root {${toStyleString(
    createCSSPropObject("painting", paintings)
  )}}`}
></style>
<!-- ICON PROPS -->
<style
  set:html={`:root {${toStyleString(createCSSPropObject("icon", icons))}}`}
></style>
<!-- UI PROPS -->
<style set:html={`:root {${toStyleString(createCSSPropObject("ui", ui))}}`}
></style>
